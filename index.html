<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>SantShop | TecnologÃ­a accesible</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- LOGO EN LA PESTAÃ‘A -->
  <link rel="icon" type="image/png" href="SantShop.png">

  <!-- LIBRERÃAS -->
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    :root{
      --dark:#020617;
      --accent:#22c55e;
      --gray:#64748b;
      --bg:#f8fafc;
    }
    *{box-sizing:border-box;margin:0;padding:0;font-family:system-ui}
    body{background:var(--bg);color:#020617}

    header{
      position:sticky;top:0;z-index:10;
      background:var(--dark);color:#fff;
      padding:15px 20px;
      display:flex;justify-content:space-between;align-items:center
    }

    .hero{
      padding:60px 20px;
      text-align:center;
      background:linear-gradient(135deg,#020617,#0f172a);
      color:#fff
    }

    .section{padding:40px 15px;max-width:1200px;margin:auto}

    .search{
      width:100%;
      padding:14px;
      border-radius:14px;
      border:1px solid #ddd;
      margin-bottom:25px;
      font-size:16px
    }

    .products{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(240px,1fr));
      gap:20px
    }
    .card{
      background:#fff;
      border-radius:20px;
      padding:15px;
      box-shadow:0 10px 25px rgba(0,0,0,.08)
    }
    .card img{width:100%;border-radius:14px}
    .card h3{margin:10px 0 5px}
    .card p{color:var(--gray);font-size:14px}
    .price{font-size:20px;font-weight:800;color:var(--accent);margin:10px 0}
    .btn{
      display:block;
      width:100%;
      padding:14px;
      background:#0f172a;
      color:#fff;
      border:none;
      border-radius:14px;
      font-weight:800;
      cursor:pointer
    }

    .cart-item{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom:10px
    }
    .cart-item button{
      background:red;
      color:#fff;
      border:none;
      border-radius:8px;
      padding:6px 10px;
      cursor:pointer
    }

    #ticket{
      width:320px;
      background:#fff;
      padding:15px;
      font-family:monospace;
      display:none
    }
    #ticket img{width:90px;display:block;margin:auto}

    .wa{
      position:fixed;
      bottom:20px;right:20px;
      background:#25D366;
      color:#fff;
      padding:15px 18px;
      border-radius:999px;
      text-decoration:none;
      font-weight:800
    }

    #adminLogin,#adminPanel{
      max-width:600px;
      margin:40px auto;
      display:none
    }
  </style>
</head>

<body>

<!-- TICKET -->
<div id="ticket">
  <img src="assets/logo.png">
  <p style="text-align:center;font-weight:800">SANTSHOP</p>
  <hr>
  <div id="ticketItems"></div>
  <hr>
  <p id="ticketTotal" style="font-weight:800"></p>
  <p style="text-align:center">Gracias por su compra ðŸ™Œ</p>
</div>

<header>
  <strong id="title">SantShop</strong>
</header>

<section class="hero">
  <h2>TecnologÃ­a accesible</h2>
  <p>Calidad real, precios honestos</p>
</section>

<section class="section">
  <input class="search" placeholder="ðŸ” Buscar producto..." oninput="searchProducts(this.value)">
  <div class="products" id="productList"></div>
</section>

<section class="section">
  <h3>ðŸ§¾ Pedido</h3>
  <div id="cartList"></div>
  <p id="cartTotal"><strong>Total: $0 MXN</strong></p>
  <button class="btn" onclick="generateTicket()">Generar ticket</button>
</section>

<!-- ADMIN -->
<div id="adminLogin">
  <h3>Admin SantShop</h3>
  <input class="search" id="adminEmail" placeholder="Correo">
  <input class="search" id="adminPass" type="password" placeholder="ContraseÃ±a">
  <button class="btn" onclick="loginAdmin()">Entrar</button>
</div>

<div id="adminPanel">
  <h3>ðŸ“Š Ventas</h3>
  <canvas id="salesChart"></canvas>
  <p id="totalSales"></p>
  <button class="btn" onclick="logoutAdmin()">Cerrar sesiÃ³n</button>
</div>

<a class="wa" href="https://wa.me/529641034714" target="_blank">WhatsApp</a>

<script>
const phone = '529641034714';
const ADMIN_EMAIL = "josuesantizobarrios@gmail.com";
const ADMIN_PASS = "0923josue";

const products = [
  {id:1,name:'AudÃ­fonos TWS',desc:'Bluetooth y estuche',price:299,img:'https://http2.mlstatic.com/D_NQ_NP_2X_697864-MLA100038119191_122025-F.webp'},
  {id:2,name:'Power Bank 10,000 mAh',desc:'Carga rÃ¡pida',price:599,img:'https://http2.mlstatic.com/D_NQ_NP_2X_995948-MLA99547949208_122025-F.webp'},
  {id:3,name:'Occiam S36',desc:'100h baterÃ­a',price:450,img:'https://http2.mlstatic.com/D_NQ_NP_2X_681843-MLA99455767776_112025-F.webp'}
];

let cart = JSON.parse(localStorage.getItem("cart")) || [];
let history = JSON.parse(localStorage.getItem("history")) || [];
let filtered = products;

function renderProducts(){
  const list = document.getElementById('productList');
  list.innerHTML = '';
  filtered.forEach(p=>{
    list.innerHTML += `
      <div class="card">
        <img src="${p.img}">
        <h3>${p.name}</h3>
        <p>${p.desc}</p>
        <div class="price">$${p.price}</div>
        <button class="btn" onclick="addToCart(${p.id})">Agregar</button>
      </div>`;
  });
}

function addToCart(id){
  const item = cart.find(i=>i.id===id);
  if(item) item.qty++;
  else{
    const p = products.find(p=>p.id===id);
    cart.push({...p,qty:1});
  }
  saveCart();
}

function removeItem(id){
  cart = cart.filter(i=>i.id!==id);
  saveCart();
}

function renderCart(){
  let total = 0;
  let html = '';
  cart.forEach(i=>{
    total += i.price * i.qty;
    html += `
      <div class="cart-item">
        ${i.qty}x ${i.name}
        <button onclick="removeItem(${i.id})">âœ•</button>
      </div>`;
  });
  document.getElementById('cartList').innerHTML = html;
  document.getElementById('cartTotal').innerText = 'Total: $'+total+' MXN';
}

function saveCart(){
  localStorage.setItem("cart",JSON.stringify(cart));
  renderCart();
}

function generateTicket(){
  const t = document.getElementById('ticket');
  let total = 0;
  document.getElementById('ticketItems').innerHTML =
    cart.map(i=>{
      total += i.price*i.qty;
      return `${i.qty}x ${i.name} - $${i.price*i.qty}`;
    }).join('<br>');
  document.getElementById('ticketTotal').innerText = 'TOTAL: $'+total+' MXN';

  history.push({date:new Date().toLocaleString(),total});
  localStorage.setItem("history",JSON.stringify(history));

  t.style.display='block';
  html2canvas(t).then(c=>{
    const a=document.createElement('a');
    a.href=c.toDataURL();
    a.download='ticket-santshop.png';
    a.click();
    t.style.display='none';
    window.open(`https://wa.me/${phone}?text=Hola, te envÃ­o mi pedido`, '_blank');
  });

  cart=[]; saveCart();
}

function searchProducts(text){
  filtered = products.filter(p =>
    p.name.toLowerCase().includes(text.toLowerCase())
  );
  renderProducts();
}

let taps=0;
document.getElementById("title").onclick=()=>{
  taps++; setTimeout(()=>taps=0,800);
  if(taps>=5) adminLogin.style.display="block";
};

function loginAdmin(){
  if(adminEmail.value===ADMIN_EMAIL && adminPass.value===ADMIN_PASS){
    localStorage.setItem("admin","1");
    adminLogin.style.display="none";
    adminPanel.style.display="block";
    drawChart();
  }else alert("Datos incorrectos");
}

function logoutAdmin(){
  localStorage.removeItem("admin");
  location.reload();
}

function drawChart(){
  new Chart(salesChart,{
    type:"line",
    data:{
      labels:history.map(h=>h.date),
      datasets:[{label:"Ventas",data:history.map(h=>h.total)}]
    }
  });
  totalSales.innerText =
    "Total vendido: $"+history.reduce((s,h)=>s+h.total,0)+" MXN";
}

if(localStorage.getItem("admin")){
  adminPanel.style.display="block";
  drawChart();
}

renderProducts();
renderCart();
</script>

</body>
</html>
